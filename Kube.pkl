module declix.podman.Kube

extends "@pkl-systemd/Unit.pkl"

unit: UnitSection?
install: InstallSection?
kube: KubeSection

// https://docs.podman.io/en/latest/markdown/podman-systemd.unit.5.html
local class KubeSection {
    // Path to Kubernetes YAML file (required)
    yaml: String
    
    // Automatic image updates
    autoUpdate: AutoUpdatePolicy?
    
    // ConfigMap YAML paths
    configMap: (String|Listing<String>)?
    
    // Containers.conf module
    containersConfModule: (String|Listing<String>)?
    
    // Network configuration
    network: String?
    
    // Expose ports from containers
    publishPort: (String|Listing<String>)?
    
    // Exit code propagation policy
    exitCodePropagation: ExitCodePolicy?
    
    // Global args
    globalArgs: (String|Listing<String>)?
    
    // Force down
    kubeDownForce: Boolean?
    
    // Working directory for relative paths (deprecated, use setWorkingDirectory)
    workingDirectory: String?
    
    // User namespace mapping
    userNS: String?
    
    // Log driver
    logDriver: String?
    
    
    // Set working directory
    setWorkingDirectory: String?
    
    // Additional podman kube play options
    podmanArgs: Listing<String>?
}

local typealias AutoUpdatePolicy = "registry" | "local" | String
local typealias ExitCodePolicy = "all" | "any" | "none"
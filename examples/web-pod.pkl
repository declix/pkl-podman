amends "../Pod.pkl"

unit = new {
    description = "Web Application Pod"
    after = "network.target"
}

pod = new {
    podName = "webapp"
    network = "bridge"
    
    publishPort = new Listing {
        "8080:80"
        "8443:443"
    }
    
    dns = new Listing {
        "8.8.8.8"
        "8.8.4.4"
    }
    
    volume = new Listing {
        "/var/log/webapp:/var/log:Z"
        "/etc/ssl/certs:/etc/ssl/certs:ro"
    }
    
    podmanArgs {
        "--hostname=webapp.local"
        "--exit-policy=stop"
        "--label=app=webapp"
        "--label=tier=web"
        "--label=environment=production"
        "--share=net"
        "--share=ipc"
    }
}

install = new {
    wantedBy = "multi-user.target"
}
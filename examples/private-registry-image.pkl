/// Private registry image unit for Podman Quadlet
module private_registry_image

import "../Image.pkl"

output {
    renderer = new YamlRenderer {}
}

privateApp: Image = new {
    unit = new {
        description = "Private application image"
        after = "network-online.target"
        wants = "network-online.target"
    }
    
    image = new {
        image = "private.company.com/apps/webapp:v2.1.0"
        imageTag = "webapp-v2.1.0"
        authFile = "/etc/containers/registries/auth.json"
        certDir = "/etc/containers/registries/certs.d"
        tlsVerify = true
        arch = "amd64"
        os = "linux"
        
        globalArgs = new Listing {
            "--log-level=info"
            "--pull-policy=missing"
        }
    }
    
    install = new {
        wantedBy = "multi-user.target"
    }
}